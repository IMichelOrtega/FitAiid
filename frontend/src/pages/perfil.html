<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FitAiid - Panel Usuario</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;600;700&display=swap" rel="stylesheet" />

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Tu CSS personalizado -->
  <link rel="stylesheet" href="../styles/perfil.css" />
</head>
<body class="min-h-screen text-white body-bg">
  <script>
    // üîí Proteger p√°gina - CORREGIDO para soportar ambos tokens
    const token = localStorage.getItem("token") || localStorage.getItem("authToken");
    const userId = localStorage.getItem("userId");
    
    if (!token) {
      console.log("‚ùå No autenticado, redirigiendo a login...");
      window.location.replace("login.html");
    } else {
      console.log("‚úÖ Usuario autenticado en perfil");
    }
  </script>
  <div class="max-w-6xl mx-auto px-6 py-10">
    <!-- Header -->
<!-- HEADER -->
<header class="navbar-header">
  <div class="logo">
    <img src="../img/logo.png" alt="FitAiid Logo">
    <div class="brand-text">
      <h2>FitAiid</h2>
      <p>Transforma Tu Cuerpo</p>
    </div>
  </div>

  <nav class="menu">
    <a href="home.html">Inicio</a>
    <a href="#">Entrenamiento</a>
    <a href="chatbot.html">Coach Virtual</a>
    <a href="nutricion.html">Nutrici√≥n</a>
    <a href="#">Estad√≠sticas</a>
  </nav>

  <div class="icons">
    <span class="bell">üîî</span>
    <button onclick="logout()" class="logout-btn">Cerrar Sesi√≥n</button>
  </div>
</header>

<style>
  /* ======== NAVBAR (espec√≠fico para no conflictuar) ======== */
  .navbar-header {
    width: 100%;
    padding: 20px 60px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: rgba(12, 12, 12, 0.85);
    backdrop-filter: blur(10px);
    position: fixed;
    top: 0;
    left: 0;
    z-index: 9999;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
  }
  #userName {
    text-transform: uppercase;
    letter-spacing: 1px;
    font-size: 30px;
  }
  body {
    padding-top: 100px !important;
  }

  .navbar-header .logo {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .navbar-header .logo img {
    width: 55px;
    height: 55px;
  }

  .navbar-header .brand-text h2 {
    color: #ff2e00;
    font-size: 22px;
    font-weight: 700;
    margin: 0;
  }

  .navbar-header .brand-text p {
    font-size: 12px;
    color: #ccc;
    font-weight: 400;
    margin: 0;
  }

  .navbar-header .menu {
    display: flex;
    gap: 40px;
    align-items: center;
  }

  .navbar-header .menu a {
    color: white;
    font-size: 18px;
    cursor: pointer;
    text-decoration: none;
    padding-bottom: 5px;
    transition: all 0.3s ease;
    border-bottom: 3px solid transparent;
  }

  .navbar-header .menu a:hover {
    color: #ff2e00;
  }

  .navbar-header .menu a.active {
    color: #ff2e00;
    border-bottom: 3px solid #ff2e00;
  }

  .navbar-header .icons {
    display: flex;
    align-items: center;
    gap: 20px;
  }

  .navbar-header .profile-link {
    text-decoration: none;
    color: #ff2e00;
    font-weight: 600;
    font-size: 16px;
    padding: 5px 10px;
    border-radius: 5px;
    transition: background 0.3s;
  }

  .navbar-header .profile-link:hover {
    background-color: rgba(255, 46, 0, 0.1);
  }

  .navbar-header .bell {
    font-size: 22px;
    cursor: pointer;
    position: relative;
    transition: transform 0.2s;
  }

  .navbar-header .bell:hover {
    transform: scale(1.1);
  }

  .navbar-header .bell::after {
    content: '';
    position: absolute;
    top: 0;
    right: 0;
    width: 8px;
    height: 8px;
    background: #ff2e00;
    border-radius: 50%;
  }

  .navbar-header .logout-btn {
    background: linear-gradient(135deg, #ff4444, #cc0000);
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 20px;
    cursor: pointer;
    font-weight: 600;
    font-size: 14px;
    transition: all 0.3s;
    font-family: "Oswald", sans-serif;
  }

  .navbar-header .logout-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 15px rgba(255, 68, 68, 0.4);
  }

  /* Responsive */
  @media (max-width: 768px) {
    .navbar-header {
      padding: 15px 20px;
      flex-wrap: wrap;
    }

    .navbar-header .menu {
      order: 3;
      width: 100%;
      justify-content: center;
      gap: 20px;
      margin-top: 15px;
      overflow-x: auto;
    }
  }
</style>

<script>
  // Marcar p√°gina activa autom√°ticamente
  document.addEventListener('DOMContentLoaded', function() {
    const currentPage = window.location.pathname.split('/').pop();
    const menuLinks = document.querySelectorAll('.navbar-header .menu a');
    
    menuLinks.forEach(link => {
      link.classList.remove('active');
      const linkPage = link.getAttribute('href');
      if (linkPage === currentPage || (currentPage === 'perfil.html' && linkPage === 'perfil.html')) {
        link.classList.add('active');
      }
    });

    // Si estamos en perfil.html, marcar "Mi Perfil" como activo tambi√©n
    if (currentPage === 'perfil.html') {
      document.querySelector('.navbar-header .profile-link').style.fontWeight = '700';
    }
  });

  // Funci√≥n logout
  function logout() {
    localStorage.removeItem("token");
    localStorage.removeItem("authToken");
    localStorage.removeItem("userId");
    localStorage.removeItem("user");
    localStorage.removeItem("userEmail");
    console.log("üö™ Sesi√≥n cerrada");
    window.location.href = "login.html";
  }
</script>

    <!-- Main panel -->
    <main class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <!-- Left -->
      <section class="lg:col-span-2">
        <div class="frost-card card-shadow rounded-2xl p-6 lg:p-8">
          <div class="flex flex-col lg:flex-row gap-6 items-center lg:items-start">
            <div class="flex-shrink-0">
              <!-- AVATAR: reemplaza el bloque anterior por este -->
                <div class="relative w-32 h-32 group">
  <!-- Imagen de avatar -->
  <img 
    id="avatarImg"
    src="https://images.unsplash.com/photo-1511367461989-f85a21fda167?q=80&w=600&auto=format&fit=crop"
    alt="Foto de perfil"
    class="w-32 h-32 rounded-full object-cover border-4 border-orange-500 shadow-lg"
  />

  <!-- Bot√≥n de edici√≥n -->
  <label 
    for="avatarInput" 
    id="uploadBtn"
    title="Cambiar foto de perfil"
    class="absolute bottom-1 right-1 bg-black/70 text-white text-sm p-2.5 rounded-full cursor-pointer hover:bg-orange-500 transition-all duration-300 shadow-md"
  >
    ‚úé
  </label>
  
  <!-- Input oculto para seleccionar archivo -->
  <input 
    type="file" 
    id="avatarInput" 
    accept="image/jpeg,image/png,image/jpg,image/webp" 
    class="hidden" 
  />
  <!-- Bot√≥n para resetear (opcional - muestra al hacer hover) -->
  <button
    id="resetAvatarBtn"
    title="Restaurar foto por defecto"
    class="absolute top-1 right-1 bg-red-600/80 text-white text-xs p-2 rounded-full cursor-pointer hover:bg-red-500 transition-all duration-300 opacity-0 group-hover:opacity-100"
  </button>
</div>

</div>
            <div class="flex-1 w-full">
              <div class="flex items-center justify-between">
                <div>
                  <h1><span class="user" id="userName">USUARIO</span></h1>
                  <div class="text-sm text-gray-300 mt-1">Nivel De Progreso</div>
                </div>
              </div>

              <div class="mt-4">
                <div class="progress-track w-full">
                  <div id="progressFill" class="progress-fill" style="width:40%"></div>
                </div>
                <div class="flex justify-between text-xs text-gray-300 mt-2">
                  <span>Principiante</span>
                  <span class="text-center">Intermedio</span>
                  <span class="text-right">Avanzado</span>
                </div>
              </div>

              <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4 items-center">
                <div>
                  <h3 class="display-font text-lg text-white/90">OBJETIVO PRINCIPAL</h3>
                  <div class="text-sm text-gray-200 mt-2" id="mainGoal">Bajar De Peso</div>
                </div>

                <div class="flex items-center justify-center">
                  <div class="w-20 h-20 rounded-full flex items-center justify-center bg-gradient-to-br from-red-700 to-orange-500">
                    <svg width="44" height="44" viewBox="0 0 24 24" fill="none">
                      <path d="M12 2s-3 4.5-3 7a3 3 0 006 0c0-2.5-3-7-3-7z" fill="white" opacity="0.95"/>
                    </svg>
                  </div>
                </div>

                <div class="text-right">
                  <h3 class="display-font text-lg text-white/90">RUTINA CUMPLIDA</h3>
                  <div class="text-sm text-gray-200 mt-2" id="streakCount">7 D√≠as Seguidos</div>
                </div>
              </div>

              <!-- Tarjetas -->
              <div class="mt-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="rounded-xl p-4 frost-card card-shadow card-bg">
                  <div class="text-xs text-gray-300">Peso Actual</div>
                  <div class="text-2xl font-bold mt-2" id="currentWeight">70 Kg</div>
                  <div class="w-full mt-3 progress-track">
                    <div id="weightProgress" class="progress-fill" style="width:40%"></div>
                  </div>
                  <div class="text-xs text-gray-400 mt-2">Meta: <span id="weightTarget">62 Kg</span></div>
                </div>

                <div class="rounded-xl p-4 frost-card card-shadow card-bg">
                  <div class="text-xs text-gray-300">De Avance</div>
                  <div class="text-3xl font-bold mt-2" id="advancePercent">75%</div>
                  <div class="text-xs text-gray-400 mt-2">Progreso general</div>
                </div>

                <div class="rounded-xl p-4 frost-card card-shadow card-bg">
                  <div class="text-xs text-gray-300">Rutinas Completadas</div>
                  <div class="text-2xl font-bold mt-2" id="routinesDone">3</div>
                  <div class="text-xs text-gray-400 mt-2">Esta semana</div>
                </div>

                <div class="rounded-xl p-4 frost-card card-shadow card-bg">
                  <div class="text-xs text-gray-300">Nivel De Motivaci√≥n</div>
                  <div class="mt-2 flex items-end h-16">
                    <div class="w-6 h-6 bg-orange-500 rounded-sm mr-2"></div>
                    <div class="w-6 h-10 bg-orange-500 rounded-sm mr-2"></div>
                    <div class="w-6 h-14 bg-orange-500 rounded-sm mr-2"></div>
                    <div class="w-6 h-20 bg-orange-500 rounded-sm"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Datos del usuario -->
        <div class="mt-6 rounded-2xl frost-card card-shadow p-6">
          <h4 class="font-bold text-white/90 mb-4">Datos del Usuario</h4>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-gray-300">
            <div>
              <div class="text-xs">Edad</div>
              <div id="userAge" class="text-lg font-semibold mt-1">20</div>
            </div>
            <div>
              <div class="text-xs">Condiciones M√©dicas</div>
              <div id="userMed" class="text-lg font-semibold mt-1">Ninguna</div>
            </div>
            <div>
              <div class="text-xs">Altura</div>
              <div id="userHeight" class="text-lg font-semibold mt-1">170 cm</div>
            </div>
          </div>
        </div>
      </section>

      <!-- Right column -->
      <aside class="space-y-4">
        <div class="rounded-2xl frost-card card-shadow p-4">
          <h5 class="font-semibold text-white/90">Resumen R√°pido</h5>
          <div class="mt-3 text-sm text-gray-300">
            <div class="flex justify-between py-2 border-b border-white/5">
              <span>Rutinas hoy</span>
              <span id="todayRoutines">2</span>
            </div>
            <div class="flex justify-between py-2 border-b border-white/5">
              <span>Kcal quemadas</span>
              <span id="kcalsBurned">420</span>
            </div>
            <div class="flex justify-between py-2">
              <span>√öltima sesi√≥n</span>
              <span id="lastSession">Hace 2 d√≠as</span>
            </div>
          </div>
        </div>

        <div class="rounded-2xl frost-card card-shadow p-4">
          <h5 class="font-semibold text-white/90">Acciones</h5>
          <div class="mt-4 grid gap-3">
            <button class="btn-primary">Iniciar Rutina</button>
            <button class="btn-outline">Registrar Peso</button>
            <button class="btn-outline">Ver Historial</button>
          </div>
        </div>

        <div class="rounded-2xl frost-card card-shadow p-4 text-gray-300">
          <h6 class="font-semibold text-white/90">Motivaci√≥n</h6>
          <p class="text-sm mt-3">Sigue as√≠ ‚Äî llevas <span id="streakSmall">7</span> d√≠as seguidos. ¬°No pierdas el ritmo!</p>
        </div>
      </aside>
    </main>
  </div>
  <section class="bg-[#121212] text-white py-10">
  <div class="max-w-6xl mx-auto px-6 grid md:grid-cols-2 gap-10">
    
    <!-- Actividad Reciente -->
    <div>
      <h2 class="text-2xl font-gagalin mb-6">ACTIVIDAD RECIENTE</h2>
      
      <div class="flex items-center gap-4 mb-4 bg-[#1E1E1E] p-3 rounded-lg">
        <span class="text-orange-500 text-3xl">üèãÔ∏è</span>
        <div>
          <p class="font-semibold">Rutina De Fuerza</p>
          <p class="text-gray-400 text-sm">22/Agosto/2025</p>
        </div>
      </div>

      <div class="flex items-center gap-4 mb-6 bg-[#1E1E1E] p-3 rounded-lg">
        <span class="text-orange-500 text-3xl">üé•</span>
        <div>
          <p class="font-semibold">Videos De Entrenamiento</p>
          <p class="text-gray-400 text-sm">22/Agosto/2025</p>
        </div>
      </div>

      <button 
  onclick="logout()" 
  class="bg-gradient-to-r from-red-600 to-orange-500 text-white font-semibold px-8 py-3 rounded-full hover:opacity-90 transition w-full sm:w-auto">
  CERRAR SESI√ìN
</button>

    </div>

    <!-- Herramientas FitAiid -->
    <div>
      <h2 class="text-2xl font-gagalin mb-6">HERRAMIENTAS FITAIID</h2>

      <div class="bg-[#1E1E1E] p-4 rounded-lg mb-4 flex items-center gap-4">
        <span class="text-orange-500 text-3xl">üßÆ</span>
        <p class="font-semibold">Calculadora Macronutrientes</p>
      </div>

      <div class="bg-[#1E1E1E] p-4 rounded-lg mb-4 flex items-center justify-between">
        <div class="flex items-center gap-4">
          <span class="text-orange-500 text-3xl">‚ö´</span>
          <p class="font-semibold">IMC Actual</p>
        </div>
        <span class="text-gray-300">24.4</span>
      </div>

      <div class="bg-[#1E1E1E] p-4 rounded-lg flex items-center justify-between">
        <div class="flex items-center gap-4">
          <span class="text-orange-500 text-3xl">üíß</span>
          <p class="font-semibold">Hidratacion</p>
        </div>
        <span class="text-gray-300">2.4 L</span>
      </div>
    </div>
  </div>
</section>
<!-- FOOTER -->
<footer class="bg-gradient-to-b from-black via-[#1a232d] to-black text-gray-300 py-16 px-10 md:px-24 mt-24 text-[17px] w-full">
  <div class="max-w-[1600px] mx-auto grid grid-cols-1 md:grid-cols-4 gap-14">

    <!-- LOGO + DESCRIPCI√ìN -->
    <div>
      <div class="flex items-center space-x-3">
        <img src="../img/logo.png" alt="FitAiid Logo" class="w-16 h-16 drop-shadow-[0_0_10px_#ff2727]">
        <h2 class="text-4xl font-extrabold tracking-wide">
          <span class="text-white">Fit</span><span class="text-[#ff2727]">Aiid</span>
        </h2>
      </div>
      <p class="mt-2 text-base font-bold text-[#ff2727] uppercase tracking-wider">
        Transforma tu cuerpo
      </p>
      <p class="mt-5 text-[15px] leading-relaxed text-gray-400">
        Tu aliado inteligente en fitness. Planes personalizados, asesoramiento nutricional con IA
        y acompa√±amiento virtual para alcanzar tu mejor versi√≥n.
      </p>
      <!-- REDES SOCIALES -->
      <div class="flex space-x-6 mt-7">
        <a href="#" class="hover:text-[#ff2727] transition-transform transform hover:scale-110">
          <i class="fa-brands fa-facebook-f text-2xl"></i>
        </a>
        <a href="#" class="hover:text-[#ff2727] transition-transform transform hover:scale-110">
          <i class="fa-brands fa-instagram text-2xl"></i>
        </a>
        <a href="#" class="hover:text-[#ff2727] transition-transform transform hover:scale-110">
          <i class="fa-brands fa-x-twitter text-2xl"></i>
        </a>
      </div>
    </div>

    <!-- NOSOTROS -->
    <div>
      <h3 class="text-[#ff2727] font-bold text-2xl mb-5 uppercase tracking-wide">Nosotros</h3>
      <ul class="space-y-3 text-[16px]">
        <li><a href="#sobre-nosotros" class="hover:text-white transition-colors">Sobre Nosotros</a></li>
        <li><a href="#servicios" class="hover:text-white transition-colors">Nuestros Servicios</a></li>
        <li><a href="#" class="hover:text-white transition-colors">Blog</a></li>
        <li><a href="#" class="hover:text-white transition-colors">Cont√°ctanos</a></li>
      </ul>
    </div>

    <!-- RECURSOS -->
    <div>
      <h3 class="text-[#ff2727] font-bold text-2xl mb-5 uppercase tracking-wide">Recursos</h3>
      <ul class="space-y-3 text-[16px]">
        <li><a href="#herramientas" class="hover:text-white transition-colors">Herramientas Fitness</a></li>
        <li><a href="#" class="hover:text-white transition-colors">Gu√≠as de Nutrici√≥n</a></li>
        <li><a href="#FAQS" class="hover:text-white transition-colors">Preguntas Frecuentes</a></li>
        <li><a href="#plan" class="hover:text-white transition-colors">Membres√≠as</a></li>
      </ul>
    </div>

    <!-- CONTACTOS -->
    <div>
      <h3 class="text-[#ff2727] font-bold text-2xl mb-5 uppercase tracking-wide">Cont√°ctanos</h3>
      <ul class="space-y-4 text-[16px]">
        <li class="flex items-center space-x-3">
          <i class="fa-solid fa-location-dot text-[#ff2727] text-lg"></i>
          <span>Colombia</span>
        </li>
        <li class="flex items-center space-x-3">
          <i class="fa-solid fa-phone text-[#ff2727] text-lg"></i>
          <span>+57 320 263 6622</span>
        </li>
        <li class="flex items-center space-x-3">
          <i class="fa-solid fa-envelope text-[#ff2727] text-lg"></i>
          <span>FitAiid@gmail.com</span>
        </li>
      </ul>
    </div>
  </div>

  <!-- COPYRIGHT -->
  <div class="border-t border-gray-700 mt-14 pt-6 text-center text-[15px] text-gray-500">
    ¬© 2025 <span class="text-[#ff2727] font-semibold">FitAiid</span> ‚Äì Todos los derechos reservados.
  </div>
</footer>

<!-- FontAwesome (para los √≠conos) -->
<script src="../scripts/avatar-system.js"></script>
<script src="https://kit.fontawesome.com/a2e0e9d6a7.js" crossorigin="anonymous"></script>
  <script src="../scripts/perfil.js"></script>
  <script src="../scripts/auth-guard.js"></script>
<script>
  function logout() {
    // Limpiar TODOS los datos de sesi√≥n
    localStorage.removeItem("token");
    localStorage.removeItem("authToken");
    localStorage.removeItem("userId");
    localStorage.removeItem("user");
    localStorage.removeItem("userEmail");
    localStorage.removeItem("userAvatar");
    
    console.log("üö™ Sesi√≥n cerrada");
    window.location.href = "login.html";
  }
</script>
<script>
  // Obtener nombre del usuario
  const userString = localStorage.getItem('user');
  if (userString) {
    try {
      const user = JSON.parse(userString);
      const userName = user.firstName || 'USUARIO';
      document.getElementById('userName').textContent = userName.toUpperCase();
    } catch (e) {
      console.error('Error al parsear usuario:', e);
    }
  }
</script>

  
</body>
</html>                                                   